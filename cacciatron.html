<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cacciatron - Spara ai cattivi</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { margin: 0; padding: 0; background: #000; color: #fff; font-family: Verdana, sans-serif;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
            overflow-x: hidden; user-select: none; touch-action: none; }
        #controls {
            display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(2, 1fr);
            width: 100%; max-width: 400px; height: 160px; gap: 8px; padding: 10px; flex-shrink: 0; order: -1;
        }
        #game-wrap { flex-grow: 1; width: 100%; max-width: 600px; display: flex; align-items: center; justify-content: center; background: #000; position: relative; }
        canvas { box-shadow: 0 0 10px rgba(0,255,0,0.2); display: block; }
        .btn { background: #333; border: 1px solid #555; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 24px; color: #aaa; cursor: pointer; }
        .btn:active { background: #0f0; color: #000; }
        #b-up { grid-column: 2; grid-row: 1; } #b-left { grid-column: 1; grid-row: 2; } #b-down { grid-column: 2; grid-row: 2; } #b-right { grid-column: 3; grid-row: 2; }
        #char-select { position: fixed; inset: 0; background: #000; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; overflow-y: auto; }
        #char-select.hidden { display: none; }
        #char-select-bg { position: absolute; inset: 0; z-index: 1; }
        #char-select-content { position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 800px; padding: 20px; }
        #leaderboard { position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.8); border: 2px solid #f80; border-radius: 8px; padding: 15px; min-width: 200px; z-index: 3; }
        #leaderboard-title { color: #f80; font-size: 18px; font-weight: bold; text-transform: uppercase; margin-bottom: 10px; text-align: center; }
        #leaderboard-list { color: #fff; font-size: 14px; }
        .leaderboard-item { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px solid rgba(255,136,0,0.2); }
        .leaderboard-item:last-child { border-bottom: none; }
        .leaderboard-rank { color: #f80; font-weight: bold; min-width: 30px; }
        .leaderboard-name { flex: 1; text-transform: capitalize; }
        .leaderboard-score { color: #f80; font-weight: bold; }
        .leaderboard-empty { color: #666; font-size: 12px; text-align: center; padding: 10px 0; }
        #consent-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 200; display: flex; align-items: center; justify-content: center; padding: 20px; }
        #consent-modal.hidden { display: none; }
        #consent-content { background: #111; border: 2px solid #f80; border-radius: 12px; padding: 30px; max-width: 600px; width: 100%; color: #fff; text-align: center; box-shadow: 0 0 40px rgba(255,136,0,0.5); display: flex; flex-direction: column; }
        #consent-title { color: #f80; font-size: 24px; font-weight: bold; text-transform: uppercase; margin-bottom: 20px; }
        #consent-char-name { color: #f80; font-weight: bold; font-size: 22px; text-transform: capitalize; }
        #consent-text { color: #ccc; font-size: 16px; line-height: 1.6; margin: 20px 0; text-align: left; }
        #consent-video { margin: 20px 0; width: 100%; max-width: 400px; aspect-ratio: 16/9; border-radius: 8px; overflow: hidden; border: 2px solid rgba(255,136,0,0.3); }
        #consent-video video { width: 100%; height: 100%; object-fit: cover; display: block; }
        #consent-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; }
        .consent-btn { padding: 12px 30px; border: 2px solid; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        #consent-accept { background: #f80; border-color: #f80; color: #000; }
        #consent-accept:hover { background: #fa0; border-color: #fa0; box-shadow: 0 0 20px rgba(255,136,0,0.8); }
        #consent-cancel { background: transparent; border-color: #666; color: #666; }
        #consent-cancel:hover { border-color: #999; color: #999; }
        #char-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 500px; width: 100%; }
        .char-item { aspect-ratio: 1; border: 2px solid #555; border-radius: 8px; overflow: hidden; cursor: pointer; background: #222; display: flex; align-items: center; justify-content: center; transition: all 0.2s; box-shadow: 0 0 15px rgba(255,136,0,0.3); }
        .char-item:hover, .char-item.selected { border-color: #f80; box-shadow: 0 0 25px rgba(255,136,0,0.6); }
        .char-item img { width: 100%; height: 100%; object-fit: cover; }
        #char-title { color: #f80; font-size: 26px; margin-bottom: 30px; text-transform: uppercase; text-shadow: 0 0 20px #f80; font-weight: bold; }
        .char-item.add-user { border: 3px dashed #f80; background: rgba(255,136,0,0.1); flex-direction: column; font-size: 16px; color: #f80; text-align: center; padding: 10px; }
        .char-item.add-user:hover { background: rgba(255,136,0,0.2); }
        .add-user-icon { font-size: 42px; margin-bottom: 8px; }
        #photo-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 300; display: flex; align-items: center; justify-content: center; padding: 20px; }
        #photo-modal.hidden { display: none; }
        #photo-content { background: #111; border: 2px solid #f80; border-radius: 12px; padding: 30px; max-width: 500px; width: 100%; color: #fff; text-align: center; box-shadow: 0 0 40px rgba(255,136,0,0.5); }
        #photo-title { color: #f80; font-size: 24px; font-weight: bold; text-transform: uppercase; margin-bottom: 20px; }
        #photo-preview { width: 100%; max-width: 300px; height: 300px; border: 2px solid #f80; border-radius: 8px; margin: 20px auto; object-fit: cover; display: none; }
        #photo-preview.show { display: block; }
        #photo-video { width: 100%; max-width: 300px; height: 300px; border: 2px solid #f80; border-radius: 8px; margin: 20px auto; object-fit: cover; display: none; transform: scaleX(-1); }
        #photo-video.show { display: block; }
        .photo-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
        .photo-btn, .photo-input-label { padding: 12px 30px; border: 2px solid #f80; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; text-transform: uppercase; color: #f80; background: transparent; }
        .photo-btn:hover, .photo-input-label:hover { background: #f80; color: #000; box-shadow: 0 0 20px rgba(255,136,0,0.8); }
        .photo-btn.secondary { color: #666; border-color: #666; }
        #file-input { display: none; }
    </style>
</head>
<body>
    <div id="consent-modal" class="hidden">
        <div id="consent-content">
            <div id="consent-title">Liberatoria</div>
            <div id="consent-char-name"></div>
            <div id="consent-text">
                <p>Dichiaro di aver preso visione che la mia immagine viene utilizzata <strong>non a scopi commerciali</strong> ma <strong>a scopi ludici e di intrattenimento amatoriale</strong> all'interno di questo gioco.</p>
                <p>Acconsento all'utilizzo della mia immagine in questo contesto.</p>
            </div>
            <div id="consent-video">
                <video id="consent-video-player" src="apparire/no.mp4" controls autoplay playsinline>Il tuo browser non supporta il video.</video>
            </div>
            <div id="consent-buttons">
                <button class="consent-btn" id="consent-accept">Accetto</button>
                <button class="consent-btn" id="consent-cancel">Annulla</button>
            </div>
        </div>
    </div>
    <div id="photo-modal" class="hidden">
        <div id="photo-content">
            <div id="photo-title">Skuccati anche tu!</div>
            <img id="photo-preview" alt="Anteprima">
            <video id="photo-video" autoplay playsinline></video>
            <div class="photo-buttons">
                <label for="file-input" class="photo-input-label">üìÅ Carica Foto</label>
                <input type="file" id="file-input" accept="image/*">
                <button class="photo-btn" id="camera-btn">üì∑ Scatta Foto</button>
                <button class="photo-btn" id="use-photo-btn" style="display: none;">‚úÖ Usa Questa Foto</button>
                <button class="photo-btn secondary" id="photo-cancel">Annulla</button>
            </div>
        </div>
    </div>
    <div id="char-select">
        <canvas id="char-select-bg"></canvas>
        <div id="leaderboard">
            <div id="leaderboard-title">Classifica</div>
            <div id="leaderboard-list"></div>
        </div>
        <div id="char-select-content">
            <div id="char-title">Scegli il tuo personaggio ‚Äì Spara ai cattivi!</div>
            <div id="char-grid"></div>
        </div>
    </div>
    <div id="controls">
        <div class="btn" id="b-up">‚ñ≤</div>
        <div class="btn" id="b-left">‚óÄ</div>
        <div class="btn" id="b-down">‚ñº</div>
        <div class="btn" id="b-right">‚ñ∂</div>
    </div>
    <div id="game-wrap">
        <canvas id="gameCanvas"></canvas>
    </div>
    <script src="cacciatron.js"></script>
</body>
</html>
